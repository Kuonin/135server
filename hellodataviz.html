<!DOCTYPE html>
<html>
 
<head>
  <meta charset="utf-8">
  <title>ZingSoft Demo</title>
 
  <script nonce="undefined" src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <style>
    html,
    body,
    #myChart {
      height: 100%;
      width: 100%;
    }
  </style>
</head>
 
<body>
  <div id='myChart'></div>
  <div id="chart"></div>
  <div id="pie"></div>
  <script>

    let screenWidths = [];
    let screenHeights = [];
    let screenHyp = [];
    let userAgents = [];
    let agents = {};
    let vals = [];
    fetch("https://katiel.site/api/static")
        .then((response) =>{
            console.log(response)
            return response.text();
        })
        .then((responses) => {
            //data = responses;
            let res = JSON.parse('[' + responses.replace(/}{(?=([^"]*"[^"]*")*[^"]*$)/g, '},{') + ']');
            console.log("start")
            console.log(responses);
            console.log("here");
            console.log(res);
            for(const obj of res){
                screenWidths.push(obj.screenWidth);
                screenHeights.push(obj.screenHeight);
                screenHyp.push(Math.sqrt(obj.screenHeight ** 2 + obj.screenWidth ** 2));
                let ag = obj.userAgent;
                ag = ag.substring(13, )
                ag = ag.split(";")[0];
                userAgents.push(ag);
                if(ag in agents)
                    agents[ag] += 1;
                else
                    agents[ag] = 1;
            }
            const uniqueUserAgents = new Set(userAgents);
            console.log(uniqueUserAgents.size);
            console.log(agents);
            for(const a of uniqueUserAgents){
                vals.push({"values" : [agents[a] / uniqueUserAgents.size * 100],
                        text : a
                });
            }
            console.log(vals);
            ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "b55b025e438fa8a98e32482b5f768ff5"];
            let chartConfig = {
            type: 'line',
            "title": {"text":"Screen widths vs screen heights vs screen diagonals"},
            series: [{
                values: screenWidths
                },
                {
                values: screenHeights
                },
                {
                values: screenHyp
                }
            ]
            };
            let cCon = {
                type: 'bar',
                "title": {"text": "screen widths and heights"},
                series: [{
                    values: screenWidths, "text": "Widths"
                    },{
                        values: screenHeights, "test" : "Heights"
                    }
                ]
            };
            let pCon = {
                "type": "pie",
                "title": {
                    "text": "UserAgents"
                },
                "series": vals,
                plot: {
                    borderColor: "#2B313B",
                    borderWidth: 5,
                    // slice: 90,
                    valueBox: {
                    placement: 'out',
                    text: '%t\n%npv%',
                    fontFamily: "Open Sans"
                    },
                    tooltip: {
                    fontSize: '18',
                    fontFamily: "Open Sans",
                    padding: "5 10",
                    text: "%npv%"
                    }}
            };
        
            zingchart.render({
            id: 'myChart',
            data: chartConfig,
            height: '100%%',
            width: '100%%'
            });
            zingchart.render({
            id: 'chart',
            data: cCon,
            height: '100%%',
            width: '100%%'
            });
            zingchart.render({
            id: 'pie',
            data: pCon,
            height: '100%%',
            width: '100%%'
            });
        })
        .catch(function(error){
            console.log(error);
        });

    
  </script>
</body>
 
</html>
<!-- <!DOCTYPE html>
<html>
 
<head>
  <meta charset="utf-8">
  <title>DataViz</title>
  
   <script nonce="undefined" src="https://cdn.zingchart.com/zingchart.min.js"></script>
</head>
 
<body>
  <h1>Data Visuals</h1>

  
  
  <div id="3barChart"></div>
  <div id="2barChart"></div>
  <div id="pieChart"></div>

  <script>
    let inData = [{"default": "none"}];
    let chartConfig = {
        "type": 'bar',
        "series": [{
            "values": [20, 40, 25, 50, 15, 45, 33, 34]
            },
            {
            "values": [5, 30, 21, 18, 59, 50, 28, 33]
            },
            {
            "values": [30, 5, 18, 21, 33, 41, 29, 15]
            }
        ]
        };
        
zingchart.render({
  id: 'myChart',
  data: chartConfig,
  height: '100%',
  width: '100%'
});

    console.log(inData);
    
  </script>
  
</body>
 
</html> -->